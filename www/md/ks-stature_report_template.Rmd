---
title: "KidStats: Stature Estimation Report"
output: pdf_document
---

```{r setup, include=FALSE, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=5, fig.heigt=3)
library(pander)
library(knitr)
```

**Analyst: `r input$analyst`**  
**Case ID: `r input$caseid`**  
Generated by KidStats: Stature v`r gui_version()` on `r Sys.Date()`  
https://elaineychu.shinyapps.io/ks-stature/  

----

```{r echo=F, message=F, warning=F}
output_df <- stat_pred()$output
output_df$`Model Type` <- str_to_title(output_df$`Model Type`)
output_df$`Variable(s)` <- recode_name(output_df$`Variable(s)`, "forward")
# print(output_df)  # FOR DEBUG
# print(input$pick_type)  # FOR DEBUG
# print(input$pick_var)  # FOR DEBUG
final_out <- output_df[output_df$`Model Type`==input$pick_type &
                         output_df$`Variable(s)`==input$pick_var, ]
# names(final_out) <- recode_name(names(final_out), "forward")

# final_out  # FOR DEBUG
```

# Report Summary

```{r echo=F}
point <- final_out$`Point Estimate (cm)`
# print(point)  # FOR DEBUG
range <- final_out$`Range (cm)`
# print(range)  # FOR DEBUG
```


\begin{minipage}[t]{0.5\textwidth}
\textbf{Stature Estimate: }
\begin{itemize}
  \item Stature Point Estimate (in cm): \textbf{`r point`}
  \item Stature Range (in cm): \textbf{`r range`}
  \item Variable Used: \textbf{`r input$pick_var`}
  \item Model type: \textbf{`r input$pick_type`}
\end{itemize}
\end{minipage}
\begin{minipage}[t]{0.5\textwidth}
\textbf{Reference Specifications:}
\begin{itemize}
  \item Sex: \textbf{`r stringr::str_to_title(input$sex)`}
  \item Geographic Region: \textbf{`r input$dem`}
\end{itemize}
\end{minipage}


```{r echo=F, warning=F, message=F, fig.width=5, fig.height=3.25}
out_plot()
```

**Input Data (in mm):**

```{r echo=F, warning=F, message=F}
case_data <- case_data()
names(case_data) <- recode_name(names(case_data), "forward")
kable(case_data)
```

\newpage

# Appendix: Results from all applicable stature estimation models

*Note: Results are sorted by increasing MAD - Mean Absolute Deviation*

`r kable(stat_pred()$appendix, row.names=F)`

